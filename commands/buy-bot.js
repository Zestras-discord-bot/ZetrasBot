// PP EMAIL

const ppEmail = "jonesbarbara2002@gmail.com";

//PRICE FOR PP

const ppPrice = 1.15;

//LIST OF ACCOUNTS

const productLimitedItemsAccounts = [
  {
    name: "CALL OF DUTY®: MW | Damascus Camo w/ 100+ Warzone Wins",
    price: 25.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW | Damascus Camo w/ 5+ Obsidian Weapons",
    price: 29.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW | Damascus Camo w/ 1+ Obsidian Camo + Level: 1000",
    price: 31.99 * ppPrice,
  },
  // {
  //     name:
  //         "CALL OF DUTY®: MW | Damascus Camo w/ 1+ Obsidian Weapon + 374 WarZone Wins + 2,92KD ",
  //     price: 79.99 * ppPrice,
  // },
  // {
  //     name:
  //         "CALL OF DUTY®: MW | Damascus Camo w/ 10+ Obsidian Weapons + 167 WarZone Wins + 44K CW Kills ",
  //     price: 69.99 * ppPrice,
  // },
  // {
  //     name: "CALL OF DUTY®: MW | Damascus Camo w/ 10+ Obsidian Weapons ",
  //     price: 63.99 * ppPrice,
  // },
  // {
  //     name:
  //         "CALL OF DUTY®: MW | Damascus Camo w/ 1+ Obsidian Weapon + 184 WarZone Wins ",
  //     price: 27.99 * ppPrice,
  // },
  // {
  //     name: "CALL OF DUTY®: MW | 3x Obsidian Snipers ",
  //     price: 2.99 * ppPrice,
  // },
  // {
  //     name: "CALL OF DUTY®: MW  Accounts | 480+ WarZone Wins",
  //     price: 34.99 * ppPrice,
  // },
];

const productCallOfDutyAccounts = [
  {
    name: "CALL OF DUTY®: MW  | Damascus Camo",
    price: 22.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | Damascus Camo + Obsidian Camo",
    price: 24.99 * ppPrice,
  },
  {
    name: "[BULK] 3x CALL OF DUTY®: MW  | 5+ Platinum Weapons",
    price: 2.25 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 10+ Platinum Weapons",
    price: 2.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 15+ Platinum Weapons",
    price: 3.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 20+ Platinum Weapons ",
    price: 4.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 25+ Platinum Weapons ",
    price: 5.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 30+ Platinum Weapons ",
    price: 6.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 35+ Platinum Weapons ",
    price: 7.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 40+ Platinum Weapons ",
    price: 8.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 45+ Platinum Weapons ",
    price: 9.49 * ppPrice,
  },
  {
    name: "[BULK] 15x CALL OF DUTY®: MW  | 1+ Gold Weapons ",
    price: 1.5 * ppPrice,
  },
  {
    name: "[BULK] 4x CALL OF DUTY®: MW  | 5+ Gold Weapons ",
    price: 1.6 * ppPrice,
  },
  {
    name: "[BULK] 2x CALL OF DUTY®: MW  | 10+ Gold Weapons",
    price: 1.6 * ppPrice,
  },
  {
    name: "[BULK] 2x CALL OF DUTY®: MW  | 1+ Obsidian Weapons",
    price: 0.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 5+ Obsidian Weapons",
    price: 4.49 * ppPrice,
  },
  {
    name:
      "[BULK] 15x CALL OF DUTY®: MW  w/ 5000 - 40000 Kills [GOLD/PLATINUM/OBSIDIAN MIX]",
    price: 1.5 * ppPrice,
  },
];

const productCallOfDutyStoreBoughtItemsAccounts = [
  //   {
  //     name: '[BULK] 3x CALL OF DUTY®: MW  | 5+ Store Bought Items',
  //     price: 2.25 * ppPrice,
  //   },
  //   {
  //     name: 'CALL OF DUTY®: MW  | 10+ Store Bought Items',
  //     price: 2.49 * ppPrice,
  //   },
  //   {
  //     name: 'CALL OF DUTY®: MW  | 15+ Store Bought Items',
  //     price: 3.49 * ppPrice,
  //   },
  //   {
  //     name: 'CALL OF DUTY®: MW  | 20+ Store Bought Items',
  //     price: 4.49 * ppPrice,
  //   },
  //   {
  //     name: 'CALL OF DUTY®: MW  | 25+ Store Bought Items',
  //     price: 5.49 * ppPrice,
  //   },
  //   {
  //     name: 'CALL OF DUTY®: MW  | 30+ Store Bought Items',
  //     price: 6.49 * ppPrice,
  //   },
  {
    name: "CALL OF DUTY®: MW  | 35+ Store Bought Items",
    price: 7.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 45+ Store Bought Items",
    price: 9.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 60+ Store Bought Items",
    price: 12.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 70+ Store Bought Items",
    price: 14.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 85+ Store Bought Items",
    price: 17.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 124+ Store Bought Items",
    price: 26.99 * ppPrice,
  },
];

const productCallOfDutyBlackOpsAccounts = [
  {
    name: "[BULK] 8x CALL OF DUTY®: BO  Cold War Accounts | 5000+ Kills",
    price: 1.6 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: BO  Cold War Accounts | 10000+ Kills",
    price: 1.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: BO  Cold War Accounts | 15000+ Kills",
    price: 2.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: BO  Cold War Accounts | 20000+ Kills",
    price: 3.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: BO  Cold War Accounts | 30000+ Kills",
    price: 5.49 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: BO  Cold War Accounts | 40000+ Kills",
    price: 7.49 * ppPrice,
  },
];

const productCallOfDutyWarZoneAccounts = [
  {
    name: "[BULK] 150x CALL OF DUTY®: MW  | Random Stats",
    price: 1.5 * ppPrice,
  },
  {
    name: "[BULK] 2x CALL OF DUTY®: MW  | 50+ WarZone Wins",
    price: 1.0 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 100+ WarZone Wins",
    price: 2.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 200+ WarZone Wins",
    price: 12.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 300+ WarZone Wins",
    price: 23.99 * ppPrice,
  },
  {
    name: "CALL OF DUTY®: MW  | 400+ WarZone Wins",
    price: 33.99 * ppPrice,
  },
];

const productVpnAccounts = [
  {
    name: "[BULK] 7x NordVPN Accounts | EXP: 2021",
    price: 1.69 * ppPrice,
  },
  {
    name: "[BULK] 3x NordVPN Accounts | EXP: 2022",
    price: 1.44 * ppPrice,
  },
  {
    name: "[BULK] 2x NordVPN Accounts | EXP: 2023",
    price: 1.92 * ppPrice,
  },
  {
    name: "NordVPN Accounts | EXP: 2024",
    price: 1.92 * ppPrice,
  },
  {
    name: "NordVPN Accounts | EXP: 2025",
    price: 3.84 * ppPrice,
  },
  {
    name: "NordVPN Accounts | EXP: 2026",
    price: 5.2 * ppPrice,
  },
  {
    name: "NordVPN Accounts | EXP: 2028",
    price: 7.2 * ppPrice,
  },
  {
    name: "[BULK] 4x TunnelBear VPN Accounts",
    price: 1.5 * ppPrice,
  },
  {
    name: "[BULK] 4x IPVanish VPN Accounts",
    price: 1.5 * ppPrice,
  },
  {
    name: "VyprVPN VPN Accounts",
    price: 1.5 * ppPrice,
  },
  {
    name: "HMA VPN Accounts",
    price: 1.99 * ppPrice,
  },
];

const productOtherAccounts = [
  {
    name: "Phone Verified Battle.net Warzone Accounts",
    price: 1.49 * ppPrice,
  },
  {
    name: "[BULK] 10x Phone Verified Battle.net Warzone Accounts",
    price: 9.99 * ppPrice,
  },
  {
    name: " [UKRAINE] Phone Verified Battle.net Warzone Accounts",
    price: 1.99 * ppPrice,
  },
  {
    name: "Battle.net Phone Verification Service [ANY COUNTRY]",
    price: 1.99 * ppPrice,
  },
  {
    name: "[BULK] 15x Spotify Accounts (Premium)",
    price: 1.5 * ppPrice,
  },
  {
    name: "Spotify Premium Upgrade (KEY + ADDY)",
    price: 1.99 * ppPrice,
  },
  {
    name: "[BULK] 3x PornHub Premium Accounts",
    price: 1.5 * ppPrice,
  },
  {
    name: "[BULK] 2x OnlyFans Accounts w/ CC Linked",
    price: 1.99 * ppPrice,
  },
  {
    name: "[BULK] 3x PornHub Premium",
    price: 1.49 * ppPrice,
  },
  {
    name: " PornHub Premium + Livecam Access",
    price: 1.49 * ppPrice,
  },
];

const activeAccountsList = [
  { list: productLimitedItemsAccounts, name: "Limited Items" },
  { list: productCallOfDutyAccounts, name: "Call of Duty Accounts" },
  {
    list: productCallOfDutyStoreBoughtItemsAccounts,
    name: "Call of Duty Store Bought Accounts",
  },
  {
    list: productCallOfDutyBlackOpsAccounts,
    name: "Call of Duty Black Ops Accounts",
  },
  {
    list: productCallOfDutyWarZoneAccounts,
    name: "Call of Duty War Zone Accounts",
  },
  { list: productVpnAccounts, name: "VPN Accounts" },
  { list: productOtherAccounts, name: "Other Accounts" },
];

//LIST OF SERVICES

const productSpotifyServices = [
  // {
  //     name: "Spotify Premium Upgrade Service",
  //     price: 2.99 * ppPrice,
  // },
  {
    name: "Spotify Followers | 1000+",
    price: 4.59 * ppPrice,
  },
  {
    name: "Spotify Followers | 2500+",
    price: 11.45 * ppPrice,
  },
  {
    name: "Spotify Followers | 5000+",
    price: 22.9 * ppPrice,
  },
];

const productInstagramServices = [
  {
    name: "Instagram Followers | 1000+ [REAL QUALITY]",
    price: 3.52 * ppPrice,
  },
  {
    name: "Instagram Followers | 2500+ [REAL QUALITY]",
    price: 8.8 * ppPrice,
  },
  {
    name: "Instagram Followers | 5000+ [REAL QUALITY]",
    price: 17.6 * ppPrice,
  },
  {
    name: "Instagram Followers | 10000+ [REAL QUALITY]",
    price: 35.2 * ppPrice,
  },
  {
    name: "Instagram Followers | 25000+ [REAL QUALITY]",
    price: 87.99 * ppPrice,
  },
  {
    name: "Instagram Followers | 50000+ [REAL QUALITY]",
    price: 175.99 * ppPrice,
  },
  {
    name: "Instagram Likes | 1000+",
    price: 2.88 * ppPrice,
  },
  {
    name: "Instagram Likes | 2500+",
    price: 7.2 * ppPrice,
  },
  {
    name: "Instagram Likes | 5000+",
    price: 14.4 * ppPrice,
  },
];

const productYouTubeServices = [
  {
    name: "YouTube Subscribers | 250+",
    price: 4.55 * ppPrice,
  },
  {
    name: "YouTube Subscribers | 500+",
    price: 9.1 * ppPrice,
  },
  {
    name: "YouTube Subscribers | 1000+",
    price: 18.2 * ppPrice,
  },
  {
    name: "YouTube Likes | 500+",
    price: 3.3 * ppPrice,
  },
  {
    name: "YouTube Likes | 1000+",
    price: 6.6 * ppPrice,
  },
  {
    name: "YouTube Likes | 3000+",
    price: 19.8 * ppPrice,
  },
];

const productOnlyFansService = [
  {
    name: "OnlyFans Subscription Service (5x Subs) ",
    price: 3.99 * ppPrice,
  },
];

const productTwitchServices = [
  {
    name: "Twitch Followers | 1000+",
    price: 2.04 * ppPrice,
  },
  {
    name: "Twitch Followers | 3000+",
    price: 6.12 * ppPrice,
  },
  {
    name: "Twitch Followers | 5000+",
    price: 10.2 * ppPrice,
  },
  {
    name: "Twitch Followers | 10000+",
    price: 20.4 * ppPrice,
  },
  {
    name: "Twitch Followers | 20000+",
    price: 40.8 * ppPrice,
  },
];

const productTikTokServices = [
  {
    name: "TikTok Followers | 1000+ [EXTREMLY HIGH QUALITY]",
    price: 2.04 * ppPrice,
  },
  {
    name: "TikTok Followers | 2500+ [EXTREMLY HIGH QUALITY]",
    price: 5.1 * ppPrice,
  },
  {
    name: "TikTok Followers | 5000+ [EXTREMLY HIGH QUALITY]",
    price: 10.2 * ppPrice,
  },
  {
    name: "TikTok Followers | 5000+ [EXTREMLY HIGH QUALITY]",
    price: 16.32 * ppPrice,
  },
];

const productCallOfDutyServices = [
  {
    name: "Modern Warfare Unlock All | RUT LIFETIME ULTIMATE Key | PC ",
    price: 39.99,
  },
  {
    name: "Modern Warfare Unlock All | Service | Xbox/PS4 ",
    price: 49.99,
  },
];

const activeServicesList = [
  { list: productSpotifyServices, name: "Spotify Services" },
  { list: productInstagramServices, name: "Instagram Services" },
  { list: productYouTubeServices, name: "Youtube Services" },
  { list: productOnlyFansService, name: "OnlyFans Services" },
  { list: productTwitchServices, name: "Twitch Services" },
  { list: productTikTokServices, name: "TikTok  Services" },
  { list: productCallOfDutyServices, name: "Call of Duty Services" },
];

module.exports = {
  async run(discord, bot, message, args) {
    // message.reply("Paypal is limited, please try again later");

    if (!message.channel.name.includes("ticket")) {
      //message.channel.name.includes("ticket")
      return message
        .reply(
          "This command can be only called inside of a ticket"
          // "PP Payments are closed, Sorry but you will have to wait till we get a new PP account"
        )
        .then(
          //This is only if the PP is limited
          (message) => {
            setTimeout(() => {
              message.delete();
            }, 5000);
          },
          (e) => console.log(e)
        );
    }

    let ticket = message.channel;

    message
      .reply(
        new discord.MessageEmbed()
          .setTitle(`Let's Get Started!`)
          .setDescription(
            "*What payment method would you like to use to pay?*\n\n**[1]** *PayPal*\n\n**[2]** *Bitcoin*\n\n**NOTE:** Type `-close` to close the ticket at any time."
          )
          .setColor(0x36393e)
      )
      .then(
        setTimeout(() => {
          message.delete();
        }, 1500),
        (e) => console.log(e)
      );
    const paymentMethodCollector = ticket.createMessageCollector((x) => true);

    paymentMethodCollector.on("collect", (message) => {
      const paymentMethodContent = message.content.toLowerCase();

      if (paymentMethodContent === "bitcoin" || paymentMethodContent === "2") {
        ticket.send(
          "*If you want to purchase using Bitcoin, then please buy using our website* **http://zestras.net/**\n\n**NOTE:** The ticket is going to get closed in 30s. **(create a new ticket if you want to purchase using PayPal)**"
        );
        paymentMethodCollector.stop();
        setTimeout(() => ticket.delete(), 30000);
        return;
      } else if (
        paymentMethodContent === "paypal" ||
        paymentMethodContent === "1"
      ) {
        paymentMethodCollector.stop();

        message.channel.send(
          `*You have selected **PayPal** as your payment method. <:paypal:761297958272237629>\n\nPlease **note** that **PayPal** prices are* **15%** higher than **Bitcoin** prices on our shop.\n\nAlso please **note** that **Zestras only** accepts **PayPal** if you have a *Friends & Family* payment option. Some countries that **DOESN'T** have a *Friends & Family* payment option are: *Brazil, China, India, Japan, Jamaica, Aruba*. If your country is in this list, then you **cannot** buy! **(please double check if you're able to send payments as Friends & Family before continuing)**\n\nLastly, **please** make sure that you **accept** these **Terms of service** before you send any money: **https://zestras.net/terms**\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
        );

        message.channel.send(
          new discord.MessageEmbed()
            .setTitle("Terms of Service")
            .setDescription(
              "*Have you read and agreed to [these](https://zestrasonline.atshop.io/terms) terms of services?*\n\n**[1]** *Yes*\n\n**[2]** *No*\n\n**NOTE:** Type `-close` to close the ticket at any time."
            )
            .setColor(0x36393e)
        );

        const acceptedTermsCollector = ticket.createMessageCollector(
          (x) => true
        );

        acceptedTermsCollector.on("collect", (message) => {
          const acceptedTermsContent = message.content.toLowerCase();

          if (acceptedTermsContent === "no" || acceptedTermsContent === "2") {
            acceptedTermsCollector.stop();
            message.channel.send(
              "*You need to accept the terms of services in order to purchase.*"
            );
            message.channel.send(
              new discord.MessageEmbed()
                .setTitle("Terms of Service")
                .setDescription(
                  "*Have you read and agreed to [these](https://zestrasonline.atshop.io/terms) terms of services?*\n\n**[1]** *Yes*\n\n**[2]** *No*\n\n**NOTE:** Type `-close` to close the ticket at any time."
                )
                .setColor(0x36393e)
            );
            const acceptedTermsSecondTimeCollector = ticket.createMessageCollector(
              (x) => true
            );
            acceptedTermsSecondTimeCollector.on("collect", (message) => {
              const acceptedTermsContentAgain = message.content.toLowerCase();
              if (
                acceptedTermsContentAgain === "no" ||
                (acceptedTermsContentAgain === "2" && !message.author.bot)
              ) {
                return (
                  ticket.delete() && acceptedTermsSecondTimeCollector.stop()
                );
              } else if (
                (!message.author.bot && acceptedTermsContentAgain === "yes") ||
                acceptedTermsContentAgain === "1"
              ) {
                acceptedTermsSecondTimeCollector.stop();
                message.channel
                  .send(`OK!! let's start over`)
                  .then(message.channel.send("-buy-bot"));
              }
            });
          } else if (
            acceptedTermsContent === "yes" ||
            acceptedTermsContent === "1"
          ) {
            acceptedTermsCollector.stop();

            message.channel.send(
              new discord.MessageEmbed()
                .setTitle("What are you looking for ??")
                .setDescription(
                  "*Please make sure to check the store to get a full list of all our products here:* **https://zestras.net/**\n\n**[1]** *Accounts*\n\n**[2]** *Services*\n\n**NOTE:** Type `-close` to close the ticket at any time."
                )
                .setColor(0x36393e)
            );

            const whatLookingForCollector = ticket.createMessageCollector(
              (x) => true
            );

            whatLookingForCollector.on("collect", (message) => {
              let collectorContent = message.content.toLowerCase();

              if (collectorContent === "service" || collectorContent === "2") {
                whatLookingForCollector.stop();
                let activeServices = activeServicesList.map(
                  (service, index) => {
                    return `**[${index + 1}]** *${service.name}*`;
                  }
                );
                let description = `*Please make sure to check the store to get a full list of all our products here:* **https://zestras.net/**\n\n${activeServices.join(
                  "\n\n"
                )}`;
                message.channel.send(
                  new discord.MessageEmbed()
                    .setTitle("Which Service ?")
                    .setDescription(
                      description +
                        "\n\n**NOTE:** Type `-close` to close the ticket at any time."
                    )
                    .setColor(0x36393e)
                );
                const whichServiceCollector = ticket.createMessageCollector(
                  (x) => true
                );
                whichServiceCollector.on("collect", (message) => {
                  collectorContent = message.content.toLowerCase();
                  let selectedService =
                    activeServicesList[parseInt(collectorContent) - 1];

                  if (
                    collectorContent === selectedService.name.toLowerCase() ||
                    collectorContent - 1 ===
                      activeServicesList.indexOf(
                        activeServicesList[parseInt(collectorContent) - 1]
                      )
                  ) {
                    whichServiceCollector.stop();

                    let productsItems = selectedService.list.map(
                      (product, index) => {
                        return `**[${
                          index + 1
                        }]** *${product.name.trim()}* [**$${product.price.toFixed(
                          2
                        )}**]`;
                      }
                    );

                    message.channel.send(
                      `*Please make sure to check the store to get a full list of all our products here:* **https://zestras.net/**\n\n*Select the product that you would like to buy:*\n\n${productsItems.join(
                        "\n"
                      )}\n\n*Please check what stock is available on the shop before picking a product.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                    );

                    const productCollector = ticket.createMessageCollector(
                      (x) => true
                    );
                    productCollector.on("collect", (message) => {
                      const productContent = message.content.toLowerCase();
                      const number = parseInt(productContent);

                      if (number.toString() === "NaN") return;
                      else if (
                        number < 1 ||
                        number > selectedService.list.length
                      )
                        return message.channel.send(
                          `*Please send a valid number.* **${number}** *is not a valid number.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                        );
                      else {
                        productCollector.stop();
                        const product = selectedService.list[number - 1];

                        message.channel.send(
                          `Send:**$${product.price.toFixed(
                            2
                          )}** *to* **${ppEmail}** as **Friends and Family**. \n\n **DO NOT ADD A NOTE TO THE PAYMENT | IF YOU DO WE WILL NOT SEND OUT THE PRODUCT!**. \n\n **Remember** to also **change** the **receiver currency** to: **USD ($)** before sending the money:\n https://imgur.com/a/e55EV2Y \nhttps://imgur.com/a/0P3TVYY \n\n*Once you have sent the money, **provide** screenshot proof that you have sent the money as **Friends and Family** to the correct **PayPal** email by showing the receipt. Receipt **MUST** display the Email you sent the money to and Fee for the Friends & Family payment option (**If you do not provide this proof then we wont send out your product**).  Once you have done that, type* **-done** *.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                        );

                        const doneCollector = ticket.createMessageCollector(
                          (x) => true
                        );

                        doneCollector.on("collect", (message) => {
                          const doneContent = message.content.toLowerCase();

                          if (doneContent === "-done") {
                            doneCollector.stop();
                            message.channel.send(
                              "*Thank you for your order!*\n**Zestras** will review this ticket soon and fulfill your order. This can take up to **24 hours** if he is offline. If you haven't received your order within 24 hours, then you'll be automatically refunded.\n\n***NOTE**: Do **NOT** delete this ticket."
                            );
                          }
                        });
                      }
                    });
                  }
                });
              } else if (
                collectorContent === "account" ||
                collectorContent === "1"
              ) {
                whatLookingForCollector.stop();
                let activeAccounts = activeAccountsList.map(
                  (account, index) => {
                    return `**[${index + 1}]** *${account.name}*`;
                  }
                );
                let description = `*Please make sure to check the store to get a full list of all our products here:* **https://zestras.net/**\n\n${activeAccounts.join(
                  "\n\n"
                )}`;
                message.channel.send(
                  new discord.MessageEmbed()
                    .setTitle("Which Account ?")
                    .setDescription(
                      description +
                        "\n\n**NOTE:** Type `-close` to close the ticket at any time."
                    )
                    .setColor(0x36393e)
                );
                const whichAccountCollector = ticket.createMessageCollector(
                  (x) => true
                );
                whichAccountCollector.on("collect", (message) => {
                  collectorContent = message.content.toLowerCase();
                  let selectedAccount =
                    activeAccountsList[parseInt(collectorContent) - 1];

                  if (
                    collectorContent === selectedAccount.name.toLowerCase() ||
                    collectorContent - 1 ===
                      activeAccountsList.indexOf(
                        activeAccountsList[parseInt(collectorContent) - 1]
                      )
                  ) {
                    whichAccountCollector.stop();

                    let productsItems = selectedAccount.list.map(
                      (product, index) => {
                        return `**[${
                          index + 1
                        }]** *${product.name.trim()}* [**$${product.price.toFixed(
                          2
                        )}**]`;
                      }
                    );

                    message.channel.send(
                      `*Please make sure to check the store to get a full list of all our products here:* **https://zestras.net/**\n\n*Select the product that you would like to buy:*\n\n${productsItems.join(
                        "\n"
                      )}\n\n*Please check what stock is available on the shop before picking a product.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                    );

                    const productCollector = ticket.createMessageCollector(
                      (x) => true
                    );
                    productCollector.on("collect", (message) => {
                      const productContent = message.content.toLowerCase();
                      const number = parseInt(productContent);

                      if (number.toString() === "NaN") return;
                      else if (
                        number < 1 ||
                        number > selectedAccount.list.length
                      )
                        return message.channel.send(
                          `*Please send a valid number.* **${number}** *is not a valid number.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                        );
                      else {
                        productCollector.stop();
                        const product = selectedAccount.list[number - 1];

                        message.channel.send(
                          `*How Many **${product.name}** would you like?*\n\n*Type any number between **1 - 999** to choose the amount of accounts you want to purchase.* \n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                        );

                        const howManyCollector = ticket.createMessageCollector(
                          (x) => true
                        );

                        howManyCollector.on("collect", (message) => {
                          const howManyContent = parseInt(message.content);

                          if (howManyContent.toString() === "NaN") return;
                          else if (howManyContent < 1 || howManyContent > 999)
                            return message.channel.send(
                              `*Please send a valid number.* **${number}** *is not a valid number.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                            );
                          else {
                            howManyCollector.stop();

                            message.channel.send(
                              `*Send*  **$${(
                                product.price * howManyContent
                              ).toFixed(
                                2
                              )}** *to* **${ppEmail}** as **Friends and Family**. \n\n **DO NOT ADD A NOTE TO THE PAYMENT | IF YOU DO WE WILL NOT SEND OUT THE PRODUCT!**. \n\n **Remember** to also **change** the **receiver currency** to: **USD ($)** before sending the money:\n https://imgur.com/a/e55EV2Y \nhttps://imgur.com/a/0P3TVYY \n\n*Once you have sent the money, **provide** screenshot proof that you have sent the money as **Friends and Family** to the correct **PayPal** email by showing the receipt. Receipt **MUST** display the Email you sent the money to and Fee for the Friends & Family payment option (**If you do not provide this proof then we wont send out your product**).  Once you have done that, type* **-done** *.*\n\n**NOTE:** Type \`-close\` to close the ticket at any time.`
                            );

                            const doneCollector = ticket.createMessageCollector(
                              (x) => true
                            );

                            doneCollector.on("collect", (message) => {
                              const doneContent = message.content.toLowerCase();

                              if (doneContent === "-done") {
                                doneCollector.stop();
                                message.channel.send(
                                  "*Thank you for your order!*\n**Zestras** will review this ticket soon and fulfill your order. This can take up to **24 hours** if he is offline. If you haven't received your order within 24 hours, then you'll be automatically refunded.\n\n***NOTE**: Do **NOT** delete this ticket."
                                );
                              }
                            });
                          }
                        });
                      }
                    });
                  }
                });
              }
            });
          } else return;
        });
      } else return;
    });
  },
  name: "buy-bot",
  aliases: ["purchase"],
  description: "Handling the bot for buying items ",
};
